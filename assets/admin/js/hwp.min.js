!function(a){"use strict";a(document).ready(function(a){a(document).on("click","#hwp_course_info .add-cover-image",function(e){var t=wp.media.editor.send.attachment,n=a(this);wp.media.editor.send.attachment=function(e,n){a("#product_cover").val(n.id),a(".product_cover img").remove(),a(".product_cover .dashicons.dashicons-no-alt").remove(),a(".product_cover").append('<a href="'+n.link+'" target="_blank" class="view_cover"><img src="'+n.sizes.thumbnail.url+'"></a><span class="dashicons dashicons-no-alt"></span>'),wp.media.editor.send.attachment=t},wp.media.editor.open(n),event.preventDefault()}),a(document).on("click","#hwp_course_info .add-video-poster",function(e){var t=wp.media.editor.send.attachment,n=a(this);wp.media.editor.send.attachment=function(e,n){a("#video_poster").val(n.id),a(".video_poster img").remove(),a(".video_poster .dashicons.dashicons-no-alt").remove(),a(".video_poster").append('<a href="'+n.link+'" target="_blank" class="view_cover"><img src="'+n.sizes.thumbnail.url+'"></a><span class="dashicons dashicons-no-alt"></span>'),wp.media.editor.send.attachment=t},wp.media.editor.open(n),event.preventDefault()}),a(document).on("click",".product_cover .dashicons.dashicons-no-alt",function(e){a(this).remove(),a(".product_cover .view_cover").remove(),a("#product_cover").val("")}),a(".hwp-datepicker").datepicker({dateFormat:"yy-mm-dd"}),a(document).on("click",".withdraw_actions a.button",function(e){e.preventDefault();var t=jQuery(this);if(!t.hasClass("disabled")){t.parents(".withdraw_actions").find("div").html("");var n=t.data("post-id"),d=t.data("action"),s=t.data("amount"),i=t.parents(".withdraw_actions").find(".action_text").val();a(".withdraw_actions a.button").removeClass("waiting"),t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_withdraw_action",nonce:hwp_ajax.nonce,post_id:n,hwp_action:d,amount:s,action_text:i}}).done(function(a){console.log(a),1==a.success?"refunded"==d?(t.parents(".withdraw_actions").find("a#approved, a#deposited, a#rejected").remove(),t.removeClass("waiting").addClass("disabled"),t.parents(".withdraw_actions").find("div").html("<p>"+a.data+"</p>")):(t.parents(".withdraw_actions").find("a.button").removeClass("disabled"),t.removeClass("waiting").addClass("disabled"),t.parents(".withdraw_actions").find("div").html("<p>"+a.data+"</p>")):(t.removeClass("waiting"),t.parents(".withdraw_actions").find("div").html("<p>"+a.data+"</p>"))}).fail(function(a){t.parents(".withdraw_actions").find("a.button").removeClass("disabled")})}}),a("ul.hwp_sort").sortable({cursor:"move",handle:"span.dashicons-editor-code",placeholder:"hwp-sortable-placeholder"}),a("table.hwp_slides tbody").sortable({cursor:"move",handle:"span.dashicons-editor-code",placeholder:"hwp-sortable-placeholder-tr"}),a(".hwp_search_post").select2({dir:"rtl",ajax:{url:hwp_ajax.url,dataType:"json",delay:250,data:function(a){return{action:"hwp_search_post",q:a}},processResults:function(a){return{results:a}},cache:!1},minimumInputLength:3}),a(".hwp_search_product").select2({dir:"rtl",ajax:{url:hwp_ajax.url,dataType:"json",delay:250,data:function(a){return{action:"hwp_search_post",q:a,post_type:"product"}},processResults:function(a){return{results:a}},cache:!1},minimumInputLength:3,initSelection:function(a,e){var t=parseInt(a.data("id")),n=a.data("text");"number"==typeof t&&"string"==typeof n&&e({id:t,text:n})}}),a(".hwp_search_users").select2({dir:"rtl",ajax:{url:hwp_ajax.url,dataType:"json",delay:250,data:function(a){return{action:"hwp_search_users",q:a}},processResults:function(a){return{results:a}},cache:!1},minimumInputLength:3,initSelection:function(a,e){var t=parseInt(a.data("id")),n=a.data("text");"number"==typeof t&&"string"==typeof n&&e({id:t,text:n})}}),a(".hwp_select").select2({dir:"rtl"}),a(".access_changer.disabled").click(function(a){a.preventDefault()}),a(document).on("change",".access_changer",function(e){e.preventDefault(),this.checked?(a(this).parents("tr").find('input[type="checkbox"].key_stat').attr("checked",!0),a(this).parents("tr").addClass("error")):(a(this).parents("tr").find('input[type="checkbox"].key_stat').attr("checked",!1),a(this).parents("tr").addClass("error"))}),a(document).on("click","a.upload_passwords",function(e){e.preventDefault();var t=jQuery(this),n=t.data("product-id");t.parents(".update_download_access").find(".result").html(""),t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_upload_passwords_list",nonce:hwp_ajax.nonce,product_id:n}}).done(function(a){t.removeClass("waiting"),1==a.success?t.parents(".update_download_access").find(".result").html('<div class="updated fade"><p>'+a.data+"</p></div>"):t.parents(".update_download_access").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")}).fail(function(a){t.removeClass("waiting"),t.parents(".update_download_access").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")})}),a(document).on("click","a.regenerate_passwords",function(e){e.preventDefault();var t=jQuery(this),n=t.data("product-id");t.parents(".update_download_access").find(".result").html(""),t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_regenerate_passwords_list",nonce:hwp_ajax.nonce,product_id:n}}).done(function(a){t.removeClass("waiting"),1==a.success?t.parents(".update_download_access").find(".result").html('<div class="updated fade"><p>'+a.data+"</p></div>"):t.parents(".update_download_access").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")}).fail(function(a){t.removeClass("waiting"),t.parents(".update_download_access").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")})}),a(document).on("click","a.hwp_add_new_buyer",function(e){e.preventDefault();var t=jQuery(this),n=t.data("product-id"),d=t.prev().val();t.parents(".add_custom_buyer").find(".result").html(""),t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_add_new_buyer_to_list",nonce:hwp_ajax.nonce,product_id:n,email:d}}).done(function(a){t.removeClass("waiting"),1==a.success?t.parents(".add_custom_buyer").find(".result").html('<div class="updated fade"><p>'+a.data+"</p></div>"):t.parents(".add_custom_buyer").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")}).fail(function(a){t.removeClass("waiting"),t.parents(".add_custom_buyer").find(".result").html('<div class="error fade"><p>'+a.data+"</p></div>")})}),a(document).on("click","a.hwp_remove_buyer",function(e){e.preventDefault();var t=jQuery(this),n=t.data("product-id"),d=t.data("key");t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_remove_buyer_from_list",nonce:hwp_ajax.nonce,product_id:n,key:d}}).done(function(a){t.removeClass("waiting"),1==a.success&&t.parent().parent().html("").html('<td colspan="5"><div class="updated fade"><p>'+a.data+"</p></div></td>")}).fail(function(a){t.removeClass("waiting"),t.parent().parent().html("").html('<td colspan="5"><div class="error fade"><p>Error</p></div></td>')})}),a(document).on("click",".add_slide_image",function(e){var t=wp.media.editor.send.attachment,n=a(this);wp.media.editor.send.attachment=function(a,e){n.next().val(e.id),n.prev().css("background-image","url("+e.sizes.full.url+")"),wp.media.editor.send.attachment=t},wp.media.editor.open(n),event.preventDefault()}),a(".hwp_bg_selector").wpColorPicker(),a(document).on("click",".hwp_change_cart_authentication",function(e){e.preventDefault();var t=jQuery(this),n=t.data("code"),d=t.data("action");t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_change_cart_authentication",nonce:hwp_ajax.nonce,code:n,hwp_action:d}}).done(function(a){console.log(a),1==a.success?t.parent().html(a.data.html+"<p>"+a.data.message+"</p>"):t.parent().html(a.data.html+"<p>"+a.data+"</p>")}).fail(function(a){alert("Failed!")}).always(function(a){t.removeClass("waiting")})}),a(document).on("click",".add_reply_btn",function(a){a.preventDefault();var e=jQuery(this),e=e.addClass("waiting"),t=(e.parents(".reply_form"),tinymce.activeEditor.getContent()),n=e.data("error"),d=e.data("ticket-id"),s=!1;""==t&&(alert(n),s=!0,jQuery(this).removeClass("waiting")),s===!1&&jQuery.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_add_ticket_reply_ajax",nonce:hwp_ajax.nonce,reply_text:t,ticket_id:d}}).done(function(a){console.log(a),e.removeClass("waiting"),jQuery(".hwp_ticket_reply_list").prepend(a.data),jQuery(".hwp_ticket_reply_list li:first-child").slideDown("300")}).fail(function(){alert("failed")})}),a(document).on("click",".hwp_ticket_delete_reply",function(a){a.preventDefault();var e=jQuery(this),t=e.parent().parent().parent(),n=e.data("delete");t.addClass("removing"),jQuery.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_ticket_delete_reply_ajax",nonce:hwp_ajax.nonce,reply_id:n}}).done(function(a){console.log(a),1==a?t.remove():(alert("Something goes wrong! Please try again"),t.removeClass("removing"))}).fail(function(){alert("failed")})}),a(document).on("click","a.hwp_featured_toggle",function(e){e.preventDefault();var t=a(this),n=t.data("comment");t.addClass("waiting"),a.ajax({url:hwp_ajax.url,type:"POST",dataType:"json",data:{action:"hwp_featured_comment_toggle",nonce:hwp_ajax.nonce,comment:n}}).done(function(a){t.find("span.dashicons").removeClass().addClass(a.data)}).fail(function(a){}).always(function(a){console.log(a),t.removeClass("waiting")})})})}(jQuery);